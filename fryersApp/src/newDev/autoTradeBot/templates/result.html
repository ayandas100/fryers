<!DOCTYPE html>
<html>
<head>
    <title>Live CE & PE Data</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-5">
    <h3 class="text-center mb-4">üìà Live Option Data</h3>
    <p class="text-center text-muted" id="countdown">üîÑ Refreshing in 15s</p>

    <div class="row">
        <div class="col-md-6">
            <h5 class="text-center">Call Option (CE)</h5>
            <div id="ce-table">‚è≥ Loading...</div>
        </div>
        <div class="col-md-6">
            <h5 class="text-center">Put Option (PE)</h5>
            <div id="pe-table">‚è≥ Loading...</div>
        </div>
    </div>

    <div class="text-center mt-4">
        <a href="/" class="btn btn-primary">‚¨ÖÔ∏è Back</a>
    </div>
</div>

<script>
    let seconds = 15;

    async function fetchData() {
        try {
            const response = await fetch('/data');
            const data = await response.json();
            document.getElementById('ce-table').innerHTML = data.ce_table;
            document.getElementById('pe-table').innerHTML = data.pe_table;
        } catch (err) {
            document.getElementById('ce-table').innerHTML = "<p class='text-danger'>Error loading CE data</p>";
            document.getElementById('pe-table').innerHTML = "<p class='text-danger'>Error loading PE data</p>";
        }
    }

    function updateCountdown() {
        document.getElementById('countdown').textContent = `üîÑ Refreshing in ${seconds}s`;
        seconds--;
        if (seconds < 0) {
            fetchData();
            seconds = 15;
        }
    }

    fetchData(); // Initial load
    setInterval(updateCountdown, 1000);
</script>
</body>
</html>
